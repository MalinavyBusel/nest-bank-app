syntax = "proto3";

package account;

service AccountService {
  rpc get (GetRequest) returns (getAccountResponse) {}
  rpc create (CreateRequest) returns (AccountId) {}
  rpc update (UpdateRequest) returns (recordsAffected) {}
  rpc delete (DeleteRequest) returns (recordsAffected) {}
  rpc getClientAccounts (Payload) returns (AccountList) {}
}

message GetRequest {
  Payload payload = 1;
  AccountId data = 2;
}

message CreateRequest {
  Payload payload = 1;
  CreateData data = 2;
}

message DeleteRequest {
  Payload payload = 1;
  AccountId data = 2;
}

message AccountId {
  string id = 1;
}

message Payload {
  string clientId = 1;
}

enum currencyTypes {
  USD = 0;
  EUR = 1;
  RUB = 2;
}

message recordsAffected {
  int32 affected = 1;
}

message Account {
  string id = 1;
  string clientId = 2;
  string bankId = 3;
  double amount = 4;
  currencyTypes currency = 5;
}

message CreateData {
  string bankId = 1;
  double amount = 2;
  currencyTypes currency = 3;
}

message UpdateRequest {
  string id = 1;
  double amount = 2;
}

message getAccountResponse {
  optional Account account = 1;
}

message AccountList {
  repeated Account accounts = 1;
}
